import numpy as np
import matplotlib.pyplot as plt
from scipy.fft import rfft, irfft, rfftfreq

t = np.linspace(0,0.5,1000)
dt = t[1] - t[0]


f_bruit = [-1.82302785e+00, -3.11440121e-01,  1.42384822e+00,  8.81605668e-01,
  3.17907835e+00,  3.35785418e+00,  1.36023278e+00,  3.72652970e+00,
 -2.57931064e+00, -2.20337214e+00, -7.67880409e-01, -3.24021117e+00,
  2.07347401e-01,  3.47694739e+00, -1.82520034e+00, -1.44145452e+00,
 -8.42808394e-01, -5.03340675e-01,  3.29461591e+00,  1.71246506e-01,
  4.42213331e+00, -2.17656710e+00,  1.16372352e+00, -5.77303977e-01,
 -1.64955321e+00, -1.75840097e+00,  1.52456332e+00,  2.58470815e+00,
  4.70479874e+00, -2.08390489e+00, -5.92880440e+00, -7.15234080e-01,
  2.22288104e+00, -4.70264818e+00, -3.82631871e+00,  1.95377039e+00,
 -3.10777814e+00, -2.16564940e+00,  3.53762273e+00, -6.59774027e-01,
 -2.83330700e+00,  5.51409407e+00, -3.56332636e-01, -2.39892986e+00,
 -1.44063209e+00,  1.79772772e+00,  4.34112500e+00,  1.71659236e+00,
 -3.57852690e-01,  3.02850957e+00, -1.97974779e+00,  1.87889629e+00,
 -1.52191969e-01,  2.93690150e+00,  4.68477117e+00,  2.65623642e-01,
  4.01087471e+00,  8.08587114e-01, -8.15821733e-02, -2.49794115e+00,
  3.23679525e-01, -2.27432025e+00, -4.62239999e-01, -2.26070748e+00,
 -2.21771788e+00,  9.38407906e-01, -7.40786595e-01, -2.58233038e-01,
 -2.54187024e+00, -2.81628948e+00, -3.61498789e+00, -3.02595452e+00,
  1.23736852e+00,  2.42408075e+00, -1.50060447e+00, -3.59786211e-01,
 -2.10256091e+00, -5.24052133e-01,  3.13812877e+00, -3.70694054e+00,
 -3.11448496e+00, -2.42964508e+00, -2.57546728e+00,  4.28761233e+00,
  3.17419022e-01,  2.25478285e+00,  2.93743514e+00,  2.77212051e+00,
 -7.90470466e-01, -3.58051025e-01,  8.18457958e-01,  2.41177327e+00,
  2.27257209e+00,  6.06765814e-01, -2.72221721e+00, -1.27581864e+00,
  3.01529541e-01, -5.17491180e+00, -5.12033194e-01,  5.48896054e+00,
 -3.17592800e+00,  4.76683695e+00,  1.87510978e+00, -7.42843736e-01,
 -1.72816784e+00, -8.76360858e-01, -4.09669998e+00,  1.42935212e+00,
 -2.93339966e-01,  1.10742339e+00, -1.78947573e+00,  1.03193934e-01,
 -8.58174260e+00, -2.56288309e+00, -3.56623937e+00, -4.44336323e+00,
  1.50583890e+00,  1.71161387e+00, -6.58643082e-01,  4.57338074e-01,
  3.00481281e-01,  2.84946925e+00, -2.76568284e+00,  2.84682368e+00,
  2.47506296e+00,  1.37584438e+00,  3.24894732e-01, -1.11686859e+00,
  8.11650780e-01, -4.50883377e+00, -1.66403316e+00,  9.85149678e-01,
  2.67315771e+00,  8.91399437e-01, -2.41207477e+00,  1.74982365e-01,
  3.10706979e+00, -4.55102917e-01,  1.79465252e+00, -9.74665666e-01,
  1.65880237e+00,  2.58751918e+00, -4.06927828e+00, -5.79379983e+00,
  2.24162348e+00, -1.13540191e+00, -1.14582188e+00,  2.42799826e+00,
 -2.42028181e+00, -1.18000984e+00, -4.51822069e+00, -4.40895403e+00,
 -4.62662306e+00, -2.75797614e+00,  3.48864247e+00, -2.61691362e+00,
  1.28301039e+00,  1.76846172e+00, -1.78196292e+00, -5.04979586e+00,
  2.28014261e+00, -2.18540932e+00, -5.58052690e+00,  1.74623585e+00,
 -1.16448129e+00,  2.55503430e+00,  2.77707129e+00,  2.29490849e+00,
 -7.30030599e-02,  3.10306769e+00,  7.47683047e+00, -2.60481485e+00,
  2.25281312e+00,  1.26510148e+00, -1.58419434e+00,  3.27087211e+00,
  9.26932278e-01, -1.94096723e+00, -3.70706631e+00, -4.82185493e+00,
 -2.66699871e+00, -4.90231912e+00, -4.56321634e-01, -1.67809627e+00,
  2.08761159e+00, -1.18609999e+00,  4.08388214e+00, -1.87951969e+00,
 -2.70940624e+00,  1.21307014e+00,  3.37098891e-01, -3.30380077e+00,
  8.07228874e-01, -8.74456555e-01,  2.21420328e+00,  1.70032066e+00,
 -4.21506900e+00, -5.96728690e+00, -5.79259375e+00, -2.25849406e+00,
  2.19562618e+00, -1.46689484e-01,  2.43215424e+00,  2.96268447e-01,
 -2.03699239e+00,  3.06924758e+00,  5.15929430e+00,  2.81701776e-01,
  1.12768213e+00, -1.78165181e+00,  1.41625722e+00,  1.08411580e+00,
 -5.14974766e+00,  1.07594362e+00,  8.89163815e-01,  2.91502348e-03,
 -1.04174604e+00,  3.61662775e-01, -1.10297064e+00,  1.10345311e+00,
  1.60601505e+00, -1.57811869e+00,  3.84428434e+00, -4.92078986e+00,
 -1.04431628e+00,  2.20756446e-01,  2.16047846e+00, -1.64602793e+00,
 -4.73303039e+00, -4.15524338e+00, -1.55667078e+00, -2.32466749e+00,
 -1.40339305e+00,  3.15760065e+00,  1.49930517e+00, -9.97906618e-01,
  4.44076629e+00,  2.16699102e+00,  2.93611055e+00,  5.05501114e+00,
 -3.65474024e+00,  3.46867404e+00,  4.20543163e+00, -6.40948393e-01,
  3.69421822e-01, -7.90097192e-01, -6.49304671e+00,  1.79232960e+00,
  5.99351356e-02,  1.89382625e+00, -2.36974172e+00, -1.91328774e+00,
 -3.50710795e+00,  3.41787384e+00, -4.93217461e-01,  3.69665115e+00,
  4.69289781e+00, -4.91249061e+00,  3.04392833e-01,  1.05552752e+00,
 -1.74444303e+00, -2.09740774e+00, -1.72410020e+00, -2.63009567e+00,
 -1.77478418e+00, -1.36771363e+00,  3.82000858e-01, -3.14087640e-01,
 -3.17094052e+00,  1.05296852e-01,  1.64311093e+00,  1.65712261e+00,
  1.39947961e+00, -2.12575016e+00,  1.08267918e+00,  1.44812242e+00,
 -2.61346381e+00, -1.04603646e+00, -2.10812500e+00, -8.64641750e+00,
 -9.90222147e-01,  1.48295979e-01, -9.93410012e-01,  3.93566915e+00,
 -5.13497047e+00, -1.43011050e+00,  4.35347412e+00,  5.46786476e+00,
  6.17601238e-01,  1.90777413e+00,  3.73873934e+00,  1.11497445e+00,
  3.15167455e+00,  2.79288671e+00,  5.22381549e-02, -2.58174103e+00,
  4.27488801e+00, -1.99388304e+00,  2.44589830e+00, -9.15625817e-02,
 -3.53240234e+00,  1.47784823e+00,  1.31110445e+00,  3.17923942e+00,
  4.49109437e+00,  5.88561305e-01,  4.55610149e+00,  1.39940126e+00,
  2.03925585e+00, -6.85063556e+00,  3.93705638e-01, -2.45202381e-01,
 -3.19349728e+00, -3.61052486e-01, -5.25853132e+00, -3.17276025e-01,
 -4.33619315e-01, -4.33978441e+00, -2.42957993e+00,  6.85313550e-01,
  1.38725859e-01, -4.04875652e-01, -1.09841100e+00,  3.06777387e+00,
  1.76601724e+00,  2.51647654e+00,  1.22195496e+00, -2.02074328e+00,
 -1.52204817e+00,  1.33797575e+00,  2.56300293e+00, -2.96421089e+00,
  6.03580841e+00, -5.79629026e-01,  2.06916781e+00,  1.97749141e+00,
  1.82197736e+00,  1.41451183e+00,  1.66490363e+00, -1.89977641e+00,
  2.99249573e+00,  1.79164042e+00, -3.12567448e-01,  5.11815479e-01,
 -3.76301610e+00, -2.08958197e+00,  2.56983387e+00, -4.35984954e+00,
 -1.62535666e+00, -6.28092482e-01, -7.47998720e-01,  2.42757526e+00,
 -1.68244792e-01, -3.33955992e+00, -5.10273109e-01,  2.80051752e+00,
 -1.08552334e+00, -2.47160527e-01, -2.99021805e-01, -2.15185295e+00,
 -2.63295428e+00, -2.76353003e+00, -3.89451182e+00, -3.44554233e-01,
  1.69290942e+00,  2.13199339e+00, -2.00765453e+00, -9.72533230e-01,
  4.32610892e+00, -2.86131808e+00,  4.06176438e+00,  5.95575258e+00,
  1.16454238e+00, -8.91768434e-02,  1.06556120e+00,  3.69397615e-01,
 -6.75363710e+00, -4.37470017e+00,  2.31776779e+00, -1.23488444e+00,
 -6.07118186e+00, -1.35348102e+00, -1.69632225e+00, -2.09525596e+00,
  1.62850940e-01,  2.59861402e+00, -1.21057536e+00, -3.38539525e+00,
 -1.94722508e+00, -8.22191208e-01,  8.29474110e-01, -9.76256179e-01,
 -1.55013987e+00, -7.13986903e-01,  5.40716631e+00, -9.09952734e-01,
 -2.80158899e+00, -2.75543815e+00,  2.62460873e+00, -7.72944813e-01,
  4.97664640e-01, -1.39251476e+00,  1.62833183e+00,  4.64073380e+00,
  1.44875852e+00,  1.42138153e+00,  9.80847013e-01,  1.49785763e+00,
 -9.42105225e-01,  1.19366743e+00, -3.23408652e+00, -5.34675160e-01,
 -1.09192460e+00, -1.37137381e+00, -3.35824769e+00,  1.34528773e+00,
  2.26594238e+00, -4.18161029e-01,  3.43306901e+00,  1.20155051e+00,
 -3.32662127e+00,  6.87738145e+00,  3.59274654e+00, -4.46782328e+00,
 -5.77211215e-01,  9.01227401e-01,  1.46161016e+00, -5.68772545e-01,
 -1.17004864e+00, -2.30045599e+00,  1.69375254e+00, -5.01523069e+00,
  6.89768900e+00, -3.79824899e+00, -3.69263144e+00,  3.10044319e+00,
  2.40930870e+00,  4.92627837e+00, -3.22964357e-01, -1.57037508e+00,
  1.40038785e+00, -3.33916183e+00, -2.08574714e+00,  1.46120117e+00,
 -1.38638168e+00, -4.87398401e+00, -2.80974728e-01,  9.28201702e-01,
 -1.85371593e+00,  1.21999435e+00,  4.17279733e+00,  1.19608086e-02,
  4.56396923e+00,  1.00502704e+00,  3.42619770e+00,  2.15197181e-01,
  1.91501171e+00, -2.77238159e+00, -5.53454548e-01,  7.01534094e-01,
 -1.36062698e+00, -2.22843318e+00, -5.32796735e-01, -1.37752029e+00,
  3.76062969e-01,  1.34346452e-01,  4.91974632e+00, -3.38691132e+00,
  2.27001524e+00,  2.31392099e+00, -3.24596379e+00, -1.23593685e+00,
 -4.15513414e-01, -7.31607403e+00,  1.33421915e+00, -4.06550696e+00,
 -2.76388777e+00,  5.94179721e-01, -2.10854638e+00, -1.63655782e+00,
  2.96256593e+00, -1.94909363e+00,  2.91364949e+00, -3.04266839e+00,
  1.56336159e+00,  1.10149689e+00, -5.63980625e-01,  4.27047401e+00,
  2.68307606e+00, -7.60494089e-01,  9.46770065e-01, -1.01217803e+00,
  2.37899088e+00,  6.48072784e-01, -3.30938893e+00, -3.39208259e+00,
  1.59944242e+00, -3.79210543e-01,  3.25775872e+00, -6.65529589e+00,
 -2.27243230e+00, -2.49936842e+00, -2.37619442e+00,  4.77458595e+00,
  1.72211571e+00,  3.66613478e+00,  3.27585878e-01, -3.43919466e+00,
 -2.70894551e+00, -2.34652781e+00,  9.60604717e-01, -1.41396605e+00,
  5.78472194e+00,  9.34050517e-01,  2.78970581e+00, -1.24467821e+00,
  1.27899637e+00, -1.41244339e+00, -1.47281230e+00, -1.30013631e+00,
 -1.82946493e+00,  9.49302099e-01,  2.06759772e+00, -6.99746759e-02,
 -2.05953394e+00,  2.52698577e+00, -3.42646528e-01,  3.32567964e+00,
 -4.26151761e-01,  3.33453128e-01,  6.30589200e-01,  1.69503082e+00,
  1.21139461e+00,  5.07130407e+00, -4.22384560e-01,  1.21892197e+00,
  2.92878130e+00,  1.86064370e+00, -1.55934173e+00,  3.36700657e-01,
  1.59096986e+00,  2.19597429e+00,  1.32979230e+00,  1.93923477e+00,
 -1.96032554e-01, -2.28511961e-01, -1.33752693e+00,  1.01027547e+00,
 -1.83656896e-01, -1.33187586e-01, -5.24174022e+00,  3.94703077e+00,
  2.11209007e+00,  5.02034292e-01, -1.90275582e+00,  3.24935846e+00,
 -3.70025336e+00, -2.42083769e+00, -7.92560109e-01, -7.76978158e-02,
  3.25952158e+00,  3.49581379e+00,  2.56954460e-01,  2.35003542e+00,
 -1.92929331e+00,  3.28025348e-01,  1.18877636e+00,  6.26717779e+00,
  4.05633638e-01, -8.81512428e-01, -3.10737686e-01,  8.07182968e+00,
  9.91257533e-01,  3.91760320e+00,  5.45570311e+00,  1.57161350e+00,
  2.42277906e+00,  4.08666183e+00, -3.86230273e-01, -1.92504131e+00,
  2.12840278e+00,  2.89419192e+00, -9.10373457e-01,  1.31675025e+00,
  3.82085814e+00, -1.43512701e+00, -7.05731540e+00, -4.02830549e+00,
 -2.31345412e-01, -7.23438206e-02, -1.02733687e+00, -3.89073604e+00,
 -6.89866824e-01,  1.58052969e+00, -2.12604686e+00, -2.09880748e+00,
  2.70043205e-01, -7.48554196e+00, -6.59788240e-01, -1.99251858e+00,
  1.84278185e+00, -1.12853583e+00, -5.65441744e-01,  7.09523918e+00,
 -2.26478139e+00,  3.85453404e+00,  2.23363093e+00, -1.84799036e+00,
 -7.09349315e-01,  1.53266309e+00, -3.81312560e+00,  2.87070756e+00,
 -3.17876303e+00, -4.34370635e+00,  3.60715488e+00, -1.32693426e+00,
 -2.57508548e+00, -8.39474252e-01,  2.23091112e+00,  2.15732356e+00,
  1.73558795e+00,  1.76324825e+00,  4.31375533e+00, -3.71095763e+00,
 -9.00686545e-02, -1.68409928e+00, -1.43428923e-01, -6.09347792e+00,
 -2.64146177e+00, -3.48410554e+00, -2.18122357e+00, -3.31404335e+00,
  1.02627484e+00, -2.07895028e+00, -9.71261444e-01,  4.61752510e+00,
  2.46168140e+00,  4.56052670e+00,  1.59132022e+00,  3.78492359e+00,
  4.03587593e+00,  4.43897214e+00, -3.20523862e+00,  2.91060288e+00,
  6.67892838e-01, -5.89705915e-01, -1.41056784e+00,  1.85998574e-01,
  3.70157236e+00,  1.66855532e+00,  1.01769424e+01,  3.51453557e+00,
  3.44187912e+00,  7.23618825e-01,  2.60493006e+00, -2.74897345e+00,
 -1.92933841e-01,  4.46316726e-01, -3.01322799e+00, -2.25510820e+00,
  1.04951967e-01, -4.93592593e+00, -5.91583845e-01, -1.66337211e+00,
 -4.12539296e+00, -2.18807543e+00, -1.54195584e+00,  2.97857699e-01,
  2.42085597e+00,  1.12174298e+00,  2.21110568e+00, -2.28970056e+00,
  2.76920044e+00,  6.47734834e-01, -3.02930211e+00, -3.31058689e+00,
  2.09613459e+00, -2.83589601e+00,  2.24451572e+00,  9.75492605e-01,
 -9.16300291e-01, -7.98892311e-01,  1.61871493e+00,  1.64127952e+00,
  3.10633621e+00,  2.26859898e-02,  3.91771891e+00,  3.70807632e+00,
  8.11674946e-01,  6.36205496e+00,  5.06511953e+00, -4.91458980e-02,
  1.42375186e-01, -9.28694497e-01, -4.24134508e-01, -4.17129586e-01,
 -2.95317414e+00, -8.65238018e-01, -2.92562858e+00, -8.22443528e-01,
 -2.11000370e+00,  5.98187943e+00,  2.68510947e+00,  1.90630637e+00,
  5.25462840e+00, -4.69750161e+00, -8.07231970e-01,  1.02817605e+00,
 -3.69576024e+00, -1.66308487e+00, -1.82526734e+00, -3.13272387e+00,
 -1.47019891e+00, -1.72631876e+00,  4.61801759e+00,  1.72945849e+00,
 -2.78501615e+00,  1.43772085e+00,  1.88892555e+00, -1.58064154e+00,
  4.34729380e+00,  3.61571248e+00, -1.60142110e+00, -3.28444211e-01,
 -2.55724012e+00, -2.13167389e+00,  1.32245306e+00, -1.05982462e+00,
  1.47901681e+00, -7.62708752e+00,  3.93671794e+00, -3.92047224e+00,
  3.91967800e+00,  1.50851663e+00,  1.48439766e+00,  6.67549531e-01,
  5.89033759e-01,  1.48365365e+00, -1.52713564e+00,  1.41959845e+00,
 -3.89937228e+00, -1.68180682e+00,  3.17560656e+00, -2.42383113e+00,
  2.27837941e+00, -5.65152956e+00, -2.32174879e+00, -3.50539130e+00,
  3.72367562e-01, -2.28466415e+00,  7.98117819e-01,  7.50285125e-02,
  2.37211945e+00, -1.39059797e-01,  1.75244650e+00,  1.99757449e+00,
 -1.08290670e+00,  1.23781150e+00, -6.40233731e-01,  2.58306043e+00,
  3.58937202e+00, -4.73788221e+00, -5.01729710e+00,  2.32604384e+00,
  4.99944293e-01,  5.31526112e+00, -3.48449989e+00,  9.72850097e-01,
  1.98708111e+00,  2.99129785e-01, -4.14878083e+00,  5.95517419e+00,
  8.56407529e-01,  2.78255092e+00, -2.74707268e+00, -4.26473964e+00,
 -1.44316617e+00, -3.38940307e-01,  2.47263623e+00,  3.43213738e+00,
 -2.91287571e+00, -4.74257295e+00,  6.28746945e-01,  1.24894662e-01,
 -4.10325710e+00, -1.55454546e+00,  9.85049994e-03, -2.30431956e+00,
 -1.19749143e+00,  3.06938775e-01,  3.24472365e+00,  5.73116198e+00,
  1.48768373e+00, -2.19814421e+00,  5.28663526e+00, -9.22164960e-01,
  1.46492302e-01,  8.04043994e-01,  5.63607537e-01, -1.39340934e+00,
  2.69203397e+00,  1.52945312e+00,  2.63221875e+00, -1.55995446e+00,
 -2.71993925e+00,  1.62830226e+00,  3.09084651e+00,  3.02476828e+00,
  2.24449101e+00,  4.05070679e+00, -3.99455843e+00, -6.28885445e-01,
 -1.58409784e+00,  1.91040743e+00,  3.12041181e+00, -1.30075823e-01,
  6.42560438e+00,  7.06607362e+00, -9.86876969e-01, -1.13974985e-01,
  4.31399314e+00, -2.15563973e+00, -3.04856804e+00,  6.50288938e+00,
 -3.02712644e+00, -4.01868266e-01,  6.83071316e-01, -3.16015327e+00,
 -2.59432465e+00, -2.09350469e+00, -2.11316353e+00, -2.47567775e+00,
  2.87961878e+00, -3.49276860e-01, -7.85815806e-01,  7.93209180e-01,
  1.76544679e+00,  2.57657141e+00, -1.45282968e+00,  1.00682167e+00,
  2.69032093e+00,  6.25717812e-01,  3.33314086e-01,  1.51868032e+00,
  5.76446977e+00, -1.81434520e+00,  4.66036136e+00, -8.03539208e-01,
  2.64667562e+00,  1.17049060e+00,  1.35089388e+00, -2.43455857e+00,
 -2.37560499e-01,  5.38467018e+00,  4.37563082e+00, -2.67988422e+00,
  2.05630867e+00,  1.69653287e+00, -3.19380845e-01, -1.49652435e+00,
 -6.59033214e+00, -4.63753580e-01,  9.94493822e-02, -5.48603419e-01,
  2.74518630e+00, -4.16801618e-01,  7.89448960e-01,  1.45152516e+00,
 -1.99999524e+00, -2.11431708e+00,  5.81921651e+00,  2.25450748e+00,
  4.53828057e+00, -1.46258960e+00, -2.37322253e+00, -4.82832248e+00,
 -5.46884349e-01, -3.67121348e-01, -1.85195070e+00,  2.04371526e+00,
 -2.85963024e+00,  2.83746443e+00, -2.78634191e-01,  1.03334811e+00,
  8.67475964e-01,  1.84093854e+00,  3.74964667e+00,  2.42430823e-01,
  1.31777569e+00,  1.86384081e+00,  2.98793390e+00, -1.66869039e+00,
  1.01231686e+00, -4.31925676e-01,  3.01190734e+00,  9.36732241e-01,
  4.19360723e+00, -2.30608775e+00, -1.56005968e+00,  6.76745784e-01,
  1.07043682e+00,  4.40569312e+00,  2.30645264e-01,  3.49072329e+00,
  2.05146864e+00, -9.90349757e-02,  1.98714564e+00,  4.18509573e+00,
 -3.24427522e+00, -5.18924712e+00, -5.65476242e+00, -3.83836630e+00,
  5.72756301e-01, -1.39862751e+00,  7.84958210e-01, -1.12547306e+00,
  1.53760705e+00, -1.17180537e+00, -1.83213906e+00, -8.39373991e-01,
  1.49492039e+00, -9.77839637e-01,  2.49688916e+00, -1.31424620e+00,
 -1.30367595e-01,  4.35356842e-02,  7.37035278e-01, -4.54264190e-01,
  2.16795584e+00, -1.54685396e+00, -2.21032359e+00, -8.03210547e-01,
  4.44238326e+00, -2.45583683e+00,  3.98983922e+00, -1.33902859e+00,
 -2.10205392e+00,  7.41303955e-01, -1.84195587e-01,  3.06483267e+00,
  1.06154184e+00, -6.57664981e-01,  1.25095856e+00, -3.66025143e+00,
  2.54349308e+00, -3.93564198e+00,  1.98469732e+00, -7.11002103e-01,
  1.81007943e+00, -1.34042999e-01,  5.15661120e-01,  2.39618232e+00,
  2.46577115e+00,  1.22894189e-01, -6.36887093e-01,  5.51551723e+00,
 -2.65853483e-01,  9.90308309e-01,  2.72318373e+00, -2.50976085e+00,
 -2.30209774e+00, -2.75810686e+00, -8.10568391e-01, -3.13640995e+00,
 -1.76004290e+00,  5.08737250e+00,  2.61073574e+00,  5.21171123e+00,
 -1.00291267e+00,  2.50096435e-01, -2.80724384e+00,  2.06765412e+00,
 -1.82115432e+00,  1.03757092e+00, -1.42225133e+00,  1.77016650e+00,
  2.32279841e-01, -3.94192528e+00,  1.85475486e+00, -4.88668564e+00,
 -4.68290760e-01, -1.87580864e+00, -6.63149348e-01, -1.17460913e+00,
 -3.05157699e+00,  1.53500409e+00, -2.15307028e+00,  8.85077050e-01,
 -8.85177233e-01, -3.61101564e-01, -2.53617058e+00,  2.95237390e+00,
  1.36826753e+00, -3.48008969e+00, -2.22435143e+00, -7.92983643e+00,
 -3.35160843e+00, -8.30928625e-01, -7.06817879e+00, -5.85479833e+00]

plt.plot(t, f_bruit)
plt.show()

yf = rfft(f_bruit)
xf = rfftfreq(len(f_bruit), dt)

plt.plot(xf, np.abs(yf))
plt.show()


fs = 1/dt
M = 2
L = 2*M + 1
fk = rfftfreq(len(f_bruit), d=dt)
wk = 2*np.pi*fk/fs
n  = fk.size

cols = [np.ones(n)]
for m in range(1, M+1):
    cols.append(2*np.cos(m*wk))
C = np.column_stack(cols)

d = np.zeros(n, dtype=float)

f1, f2 = 0.0, fs/10.0
d[(fk >= f1) & (fk <= f2)] = 1.0

a, *_ = np.linalg.lstsq(C, d, rcond=None)

h = np.zeros(L, dtype=float)
h[M] = a[0]
for m in range(1, M+1):
    h[M-m] = a[m]
    h[M+m] = a[m]

y = np.convolve(f_bruit, h, mode='same')

X = rfft(f_bruit); Y = rfft(y)
F = rfftfreq(len(f_bruit), d=dt)

plt.figure(); plt.plot(F, np.abs(X), label="avant")
plt.plot(F, np.abs(Y), label="après"); plt.legend(); plt.title("Spectre")
plt.figure(); plt.plot(y); plt.title("Signal filtré"); plt.show()